#!/bin/sh

# Workspaces for the first monitor's panel.

mondex=${MON:$(( ${#MON} - 1 ))}
desktop=$(( 3 * ${mondex} - 2 ))

ws=""
IFS=':' read -a wm_stat <<< $(bspc wm -g)

wksp_names=( wksp_${mondex}_{1..3} )

# This is a pretty ugly hack, but for the meantime,
# I haven't found another way to make it work.

for x in ${wksp_names[@]}; do
  for y in ${wm_stat[@]}; do
    if [[ "${x}" == "${y#?}" ]]; then
      wksp_stats+=( "${y}" )
    fi
  done
done

for item in ${wksp_stats[@]}
do
  if [ "$item" == "LT" ]
  then
    ws="${ws}%{S+}"
  else
    desk=""
    case $item in
      O*) # focused occupied
        desk=" -*- "
      ;;
      F*) # focused free
        desk="  *  "
      ;;
      U*) # focused urgent
        desk=" >*< "
      ;;
      o*) # occupied
        desk=" %{F${color2}}-*-%{F-} "
      ;;
      f*) # free
        desk="  %{F${color2}}*%{F-}  "
      ;;
      u*) # urgent
        desk=" %{F${color2}}>*<%{F-} "
      ;;
    esac
    shift
    if [ "$desk" != "" ]
    then
      ws="${ws}%{A:bspc desktop -f ^$desktop:}${desk}%{A}"
      desktop=$((desktop+1))
    fi
  fi
done
echo "${ws}"
