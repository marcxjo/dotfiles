#!/bin/sh

# Workspaces for the first monitor's panel.

desktop=1
ws=""
IFS=':' read -a array <<< $(bspc wm --get-status)

wksp1="Kvar"
wksp2="Kvin"
wksp3="Ses"

# This is a pretty ugly hack, but for the meantime,
# I haven't found another way to make it work.

for (( i=0; i<${#array[@]}; i++ )); do
    if [[ "${array[i]#?}" == "${wksp1}" ]]; then
        array=( "${array[@]:0:$i}" "${array[@]:$((i + 1))}" )
    fi
done

for (( j=0; j<${#array[@]}; j++ )); do
    if [[ "${array[j]#?}" == "${wksp2}" ]]; then
        array=( "${array[@]:0:$j}" "${array[@]:$((j + 1))}" )
    fi
done

for (( k=0; k<${#array[@]}; k++ )); do
    if [[ "${array[k]#?}" == "${wksp3}"  ]]; then
        array=( "${array[@]:0:$k}" "${array[@]:$((k + 1))}" )
    fi
done

for item in "${array[@]}"
do
	if [ "$item" == "LT" ]
	then
		ws="${ws}%{S+}"
	else
		desk=""
		case $item in
			O*) # focused occupied
				desk=" -*- "
			;;
			F*) # focused free
				desk="  *  "
			;;
			U*) # focused urgent
				desk=" >*< "
			;;
			o*) # occupied
				desk=" %{F${color2}}-*-%{F-} "
			;;
			f*) # free
				desk="  %{F${color2}}*%{F-}  "
			;;
			u*) # urgent
				desk=" %{F${color2}}>*<%{F-} "
			;;
		esac
		shift
		if [ "$desk" != "" ]
		then
			ws="${ws}%{A:bspc desktop -f ^$desktop:}${desk}%{A}"
			desktop=$((desktop+1))
		fi
	fi
done
echo "${ws}"
